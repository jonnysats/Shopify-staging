{%- liquid
	render 'section-padding', padding_amount_top: section.settings.padding_amount_top, padding_amount_bottom: section.settings.padding_amount_bottom
	assign lazyload_style = 'lazy'
	comment
	  Check is this is the first section on the page
	endcomment
	assign is_first_section = false
	if section.index == 1
		assign is_first_section = true

		comment
			If first section load image eager
		endcomment
		assign lazyload_style = 'eager'
	endif
-%}
{%- comment -%} MATCH COLLECTIONS {%- endcomment -%}
{%- if section.blocks.size > 0 -%}
	{%- for block in section.blocks -%}
		{%- if collections[block.settings.collection].id == collection.id and block.settings.image != blank -%}
			{%- liquid
				comment
				  Transform Shopify Text Alignment to BT code (start|center|end)
				endcomment
				assign text_alignment_desktop = block.settings.text_alignment_desktop | replace: 'left', 'start' | replace: 'right', 'end'
				assign text_alignment_mobile = block.settings.text_alignment_mobile | replace: 'left', 'start' | replace: 'right', 'end'
			
				comment
				  Prep the code for the overlay
				endcomment
				if block.settings.overlay_option == 'gradient'
					assign overlay_color = block.settings.overlay_gradient
				else
					assign overlay_color = block.settings.overlay_color
				endif
			-%}
			{{ 'hero.css' | asset_url | stylesheet_tag: preload: is_first_section }}
			<style>
				#shopify-section-{{ section.id }} { min-height: calc({{ section.settings.height_mobile }} - var(--header-height)); }
				@media (min-width: 768px) {
					#shopify-section-{{ section.id }} { min-height: {% if section.settings.height == '100vh' %}calc({{ section.settings.height }} - var(--header-height)){% else %}{{ section.settings.height }}{% endif %}; }
				}
				{%- if section.settings.height_mobile != 'auto' and section.settings.height_mobile != '100vh' -%}
					@media (max-width: 768px) {
						#shopify-section-{{ section.id }} .hero { min-height: {{ section.settings.height_mobile }}; }
					}
				{%- endif -%}
				{%- if section.settings.height != 'auto' and section.settings.height != '100vh' -%}
					@media (min-width: 768px) {
						#shopify-section-{{ section.id }} .hero { min-height: {{ section.settings.height }}; }
					}
				{%- endif -%}
			</style>
			<div class="hero position-relative" style="--heading-color: {{ block.settings.heading_color }}; --subheading-color: {{ block.settings.subheading_color }}; --copy-color: {{ block.settings.copy_color }};" {{ block.shopify_attributes }}>
				{%- render 'hero-inner-section',
					is_first_section: is_first_section,
					show_overlay: block.settings.show_overlay,
					overlay_color: overlay_color, 
					overlay_opacity: block.settings.overlay_opacity,
					image: block.settings.image,
					image_mobile: block.settings.image_mobile,
					heading: block.settings.heading,
					subheading: block.settings.subheading,
					copy: block.settings.copy,
					button_copy_1: block.settings.button_copy_1,
					button_url_1: block.settings.button_url_1,
					button_copy_2: block.settings.button_copy_2,
					button_url_2: block.settings.button_url_2,
					vertical_alignment_desktop: block.settings.vertical_alignment_desktop,
					vertical_alignment_mobile: block.settings.vertical_alignment_mobile,
					horizontal_alignment_desktop: block.settings.horizontal_alignment_desktop,
					horizontal_alignment_mobile: block.settings.horizontal_alignment_mobile,
					text_alignment_desktop: text_alignment_desktop,
					text_alignment_mobile: text_alignment_mobile,
					featured_product: block.settings.featured_product,
					featured_product_short_name: block.settings.product_short_name,
					lazyloading_style: lazyload_style
				-%}
			</div>
		{%- endif -%}
	{%- endfor -%}
{%- endif -%}

{% schema %}
{
  "name": "Collection Hero",
  "class": "section-collection-hero",
  "tag": "section",
  "settings": [
	{
		"type": "header",
		"content": "Hero Heights"
	},
	{
		"type": "select",
		"id": "height",
		"label": "Banner Height",
		"options": [
			{
				"value": "800px",
				"label": "800px"
			},
			{
				"value": "100vh",
				"label": "Full Height"
			},
			{
				"value": "auto",
				"label": "Natural"
			}
		],
		"default": "800px"
	},
	{
		"type": "select",
		"id": "height_mobile",
		"label": "Banner Height (mobile)",
		"options": [
			{
				"value": "500px",
				"label": "500px"
			},
			{
				"value": "100vh",
				"label": "Full Height"
			},
			{
				"value": "auto",
				"label": "Natural"
			}
		],
		"default": "500px"
	},
	{
		"type": "header",
		"content": "Section Settings"
	},
	{
		"type": "select",
		"id": "padding_amount_top",
		"label": "Top Section Padding",
		"options": [
			{
				"value": "no",
				"label": "None"
			},
			{
				"value": "small",
				"label": "Small"
			},
			{
				"value": "default",
				"label": "Medium (Default)"
			},
			{
				"value": "large",
				"label": "Large"
			},
			{
				"value": "xlarge",
				"label": "Extra Large"
			}
		],
		"default": "no"
	},
	{
		"type": "select",
		"id": "padding_amount_bottom",
		"label": "Bottom Section Padding",
		"options": [
			{
				"value": "no",
				"label": "None"
			},
			{
				"value": "small",
				"label": "Small"
			},
			{
				"value": "default",
				"label": "Medium (Default)"
			},
			{
				"value": "large",
				"label": "Large"
			},
			{
				"value": "xlarge",
				"label": "Extra Large"
			}
		],
		"default": "default"
	}
  ],
  "blocks": [
	{
	  "name": "Hero Image",
	  "type": "hero",
	  "settings": [
		{
			"type": "header",
			"content": "Select a collection"
		},
		{
			"type": "collection",
			"id": "collection",
			"label": "Matching Collection"
		},
		{
			"type": "header",
			"content": "Image",
		},
		{
			"type": "image_picker",
			"id": "image",
			"label": "Image"
		},
		{
			"type": "image_picker",
			"id": "image_mobile",
			"label": "Image",
			"info": "Optional"
		},
		{
			"type": "header",
			"content": "Overlay"
		},
		{
			"type": "checkbox",
			"id": "show_overlay",
			"label": "Show Overlay?"
		},
		{
			"type": "select",
			"id": "overlay_option",
			"label": "Overlay Options",
			"options": [
				{
					"value": "gradient",
					"label": "Gradient"
				},
				{
					"value": "color",
					"label": "Single Color"
				}
			],
			"default": "gradient"
		},
		{
			"type": "color_background",
			"id": "overlay_gradient",
			"label": "Overlay Gradient",
			"default": "linear-gradient(180deg, rgba(0, 0, 0, 0) 35%, rgba(0, 0, 0, 0.8) 100%)"
		},
		{
		  "type": "color",
		  "id": "overlay_color",
		  "label": "Hero Overlay Color",
		  "default": "#000000"
		},
		{
		  "type": "range",
		  "id": "overlay_opacity",
		  "min": 0,
		  "max": 100,
		  "step": 10,
		  "unit": "%",
		  "label": "Opacity",
		  "default": 20
		},
		{
			"type": "header",
			"content": "Copy",
		},
		{
			"type": "text",
			"id": "heading",
			"label": "Heading"
		},
		{
			"type": "color",
			"id": "heading_color",
			"label": "Heading Text Color",
			"default": "#fff"
		},
		{
			"type": "inline_richtext",
			"id": "subheading",
			"label": "Subheading"
		},
		{
			"type": "color",
			"id": "subheading_color",
			"label": "Subheading Text Color",
			"default": "#fff"
		},
		{
			"type": "richtext",
			"id": "copy",
			"label": "Copy"
		},
		{
			"type": "color",
			"id": "copy_color",
			"label": "Copy Color",
			"default": "#fff"
		},
		{
			"type": "text",
			"id": "button_copy_1",
			"label": "Primary Button"
		},
		{
			"type": "url",
			"id": "button_url_1",
			"label": "Primary Link"
		},
		{
			"type": "text",
			"id": "button_copy_2",
			"label": "Secondary Button"
		},
		{
			"type": "url",
			"id": "button_url_2",
			"label": "Secondary Link"
		},
		{
			"type": "header",
			"content": "Desktop Alignment"
		},
		{
			"type": "select",
			"id": "vertical_alignment_desktop",
			"label": "Vertical Alignment",
			"options": [
				{
					"value": "start",
					"label": "Top"
				},
				{
					"value": "center",
					"label": "Center"
				},
				{
					"value": "end",
					"label": "Bottom"
				}
			],
			"default": "end"
		},
		{
			"type": "select",
			"id": "horizontal_alignment_desktop",
			"label": "Horizontal Alignment",
			"options": [
				{
					"value": "start",
					"label": "Left"
				},
				{
					"value": "center",
					"label": "Center"
				},
				{
					"value": "end",
					"label": "Right"
				}
			],
			"default": "start"
		},
		{
			"type": "text_alignment",
			"id": "text_alignment_desktop",
			"label": "Text Alignment",
			"default": "left"
		},
		{
			"type": "header",
			"content": "Mobile Alignment"
		},
		{
			"type": "select",
			"id": "vertical_alignment_mobile",
			"label": "Vertical Alignment (Mobile)",
			"options": [
				{
					"value": "start",
					"label": "Top"
				},
				{
					"value": "center",
					"label": "Center"
				},
				{
					"value": "end",
					"label": "Bottom"
				}
			],
			"default": "center"
		},
		{
			"type": "select",
			"id": "horizontal_alignment_mobile",
			"label": "Horizontal Alignment (Mobile)",
			"options": [
				{
					"value": "start",
					"label": "Left"
				},
				{
					"value": "center",
					"label": "Center"
				},
				{
					"value": "end",
					"label": "Right"
				}
			],
			"default": "center"
		},
		{
			"type": "text_alignment",
			"id": "text_alignment_mobile",
			"label": "Text Alignment (Mobile)",
			"default": "center"
		},
		{
			"type": "header",
			"content": "Featured Product"
		},
		{
			"type": "product",
			"id": "featured_product",
			"label": "Featured Product"
		},
		{
			"type": "text",
			"id": "product_short_name",
			"label": "Product Short Name",
			"info": "Will replace original product name if provided"
		}
	  ]
	}
  ]
}
{% endschema %}