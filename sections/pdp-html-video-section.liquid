{%- liquid
	comment
	  Check is this is the first section on the page
	endcomment
	if section.index == 1
		assign is_first_section = true
	else
		assign is_first_section = false
	endif
	assign display_section = false
	if section.blocks.size > 0
		for block in section.blocks
			if block.settings.video != blank
				assign display_section = true
			endif
		endfor
	endif
-%}
{%- if display_section -%}
	{{ 'video.css' | asset_url | stylesheet_tag: preload: is_first_section }}
	<script src="{{ 'video-banner.js' | asset_url }}" defer crossorigin="anonymous"></script>
	{%- render 'section-padding', padding_amount_top: section.settings.padding_top, padding_amount_bottom: section.settings.padding_bottom -%}
	{%- capture empty_placeholder -%}
		{%- comment -%} Display placeholder for preview image {%- endcomment -%}
		<div class="video-wrapper d-flex w-100 flex-wrap align-items-center justify-content-center position-relative">
			{%- render 'responsive-bg-image' -%}
			<div class="heading-wrapper container d-flex align-items-{{ section.settings.vertical_alignment_mobile }} align-items-lg-{{ section.settings.vertical_alignment_desktop }} justify-content-{{ section.settings.horizontal_alignment_mobile }} justify-content-lg-{{ section.settings.horizontal_alignment_desktop }} h-100 text-{{ text_alignment_mobile }} text-lg-{{ text_alignment_desktop }} p-4 p-lg-5">
				<div class="copy-wrapper">
					{%- if block.settings.heading != blank -%}
						{%- if is_first_section == true -%}
							<h1 class="title">{{ block.settings.heading }}</h1>
						{%- else -%}
							<h2 class="title">{{ block.settings.heading }}</h2>
						{%- endif -%}
					{%- endif -%}
					{%- if block.settings.hero_subheading != blank -%}<p class="subheading pb-3 h4">{{ block.settings.hero_subheading }}</p>{%- endif -%}
					{%- if block.settings.hero_caption != blank -%}<p class="caption mb-4">{{ block.settings.hero_caption }}</p>{%- endif -%}
					{%- if block.settings.btn_text != blank and block.settings.btn_link != blank -%}
						<a class="btn btn-secondary" href="{{ block.settings.btn_link }}" title="{{ block.settings.btn_text }}">{{ block.settings.btn_text }}</a>
					{%- endif -%}
				</div>
			</div>
		</div>
	{%- endcapture -%}
	{%- if section.blocks.size > 0 -%}
		<!-- VIDEO -->
		{%- for block in section.blocks -%}
			{%- liquid
				assign text_alignment_mobile = block.settings.text_alignment_mobile | replace: 'Left', 'start' | replace: 'Center', 'center' | replace: 'Right', 'end'
				assign text_alignment_desktop = block.settings.text_alignment_desktop | replace: 'Left', 'start' | replace: 'Center', 'center' | replace: 'Right', 'end'
				assign vertical_alignment_desktop = block.settings.vertical_alignment_desktop | replace: 'Top', 'start' | replace: 'Center', 'center' | replace: 'Bottom', 'end'
				assign horizontal_alignment_desktop = block.settings.horizontal_alignment_desktop | replace: 'Left', 'start' | replace: 'Center', 'center' | replace: 'Right', 'end'
				assign vertical_alignment_mobile = block.settings.vertical_alignment_mobile | replace: 'Top', 'start' | replace: 'Center', 'center' | replace: 'Bottom', 'end'
				assign horizontal_alignment_mobile = block.settings.horizontal_alignment_mobile | replace: 'Left', 'start' | replace: 'Center', 'center' | replace: 'Right', 'end'
			-%}
			<div data-section-id="{{ section.id }}" id="videoBanner-{{ section.id }}" data-section-type="videoBanner" data-provider="{% if block.settings.provider != blank %}{{ block.settings.provider | handleize }}{%- else -%}shopify{% endif %}" data-video-id="{% if block.settings.video_id != blank %}{{ block.settings.video_id }}{% elsif block.settings.video != blank %}{{ block.settings.video.id }}{% endif %}" data-video-autoplay="{{ section.settings.autoplay }}" style="--heading-color: {{ block.settings.heading_color }}; --subheading-color: {{ block.settings.subheading_color }}; --caption-color: {{ block.settings.caption_color }};">
				{%- if block.settings.video != blank -%}
					{%- if section.settings.autoplay == true -%}
						<div class="video-wrapper d-flex w-100 flex-wrap align-items-center justify-content-center position-relative">
							<div class="heading-wrapper d-flex align-items-{{ vertical_alignment_mobile }} align-items-lg-{{ vertical_alignment_desktop }} justify-content-{{ horizontal_alignment_mobile }} justify-content-lg-{{ horizontal_alignment_desktop }} h-100 text-{{ text_alignment_mobile }} text-lg-{{ text_alignment_desktop }} p-4 p-lg-5 w-100">
								<div class="copy-wrapper">
									{%- if block.settings.heading != blank -%}
										{%- if is_first_section == true -%}
											<h1 class="title">{{ block.settings.heading }}</h1>
										{%- else -%}
											<h2 class="title">{{ block.settings.heading }}</h2>
										{%- endif -%}
									{%- endif -%}
									{%- if block.settings.hero_subheading != blank -%}<p class="subheading pb-3 h4">{{ block.settings.hero_subheading }}</p>{%- endif -%}
									{%- if block.settings.hero_caption != blank -%}<p class="caption mb-4">{{ block.settings.hero_caption }}</p>{%- endif -%}
									{%- if block.settings.btn_text != blank and block.settings.btn_link != blank -%}
										<a class="btn btn-secondary" href="{{ block.settings.btn_link }}" title="{{ block.settings.btn_text }}">{{ block.settings.btn_text }}</a>
									{%- endif -%}
								</div>
							</div>
					{%- endif -%}
						<div id="V{{ section.id }}" class="video-player position-relative w-100">
							<div class="desktop h-100{% if block.settings.mobile_video != blank %} d-none d-lg-block{% endif %}">
								{{ block.settings.video | video_tag: autoplay: section.settings.autoplay, preload: 'metadata', image_size: '2400x', loop: section.settings.loop }}
							</div>
							{%- if section.settings.autoplay != true -%}
								<div class="sound-icon sound" data-sound-icon>
									{%- render 'icons' with 'volume-off' -%}
									{%- render 'icons' with 'volume-on' -%}
								</div>
							{%- endif -%}
							{%- if block.settings.mobile_video != blank -%}
								<div class="d-lg-none h-100">
									{{ block.settings.mobile_video | video_tag: autoplay: section.settings.autoplay, preload: 'metadata', image_size: '2400x', loop: section.settings.loop }}
								</div>
							{%- endif -%}
						</div>
					{%- if section.settings.autoplay == true -%}</div>{%- endif -%}
				{%- else -%}
					{%- comment -%} Display placeholder for preview image {%- endcomment -%}
					{{- empty_placeholder -}}
				{%- endif -%}
			</div>
		{%- endfor -%}
	{%- else -%}
		{%- comment -%} Display placeholder for preview image {%- endcomment -%}
		{{- empty_placeholder -}}
	{%- endif -%}
{%- endif -%}
{% schema %}
{
	"name": "PDP Video Banner",
	"class": "section-video-banner",
	"tag": "section",
	"max_blocks": 1,
	"settings": [
		{
			"type": "header",
			"content": "Video Options"
		},
		{
			"type": "checkbox",
			"id": "autoplay",
			"label": "Autoplay",
			"default": true,
			"info": "Copy will only show if autoplay is ON"
		},
		{
			"type": "checkbox",
			"id": "loop",
			"label": "Loop Video?",
		},
		{
			"type": "header",
			"content": "Section Settings"
		},
		{
			"type": "select",
			"id": "padding_top",
			"label": "Top Section Padding",
			"options": [
				{
					"value": "no",
					"label": "None"
				},
				{
					"value": "small",
					"label": "Small"
				},
				{
					"value": "default",
					"label": "Medium (Default)"
				},
				{
					"value": "large",
					"label": "Large"
				},
				{
					"value": "xlarge",
					"label": "Extra Large"
				}
			],
			"default": "default"
		},
		{
			"type": "select",
			"id": "padding_bottom",
			"label": "Bottom Section Padding",
			"options": [
				{
					"value": "no",
					"label": "None"
				},
				{
					"value": "small",
					"label": "Small"
				},
				{
					"value": "default",
					"label": "Medium (Default)"
				},
				{
					"value": "large",
					"label": "Large"
				},
				{
					"value": "xlarge",
					"label": "Extra Large"
				}
			],
			"default": "default"
		}
	],
	"blocks": [
		{
			"name": "Shopify Hosted Video",
			"type": "shopify_video",
			"settings": [
				{
					"type": "video",
					"id": "video",
					"label": "Shopify Hosted Video"
				},
				{
					"type": "video",
					"id": "mobile_video",
					"label": "Shopify Hosted Video (Mobile)"
				},
				{
					"type": "header",
					"content": "Desktop Alignment"
				},
				{
					"type": "text",
					"id": "vertical_alignment_desktop",
					"label": "Vertical Alignment"
				},
				{
					"type": "text",
					"id": "horizontal_alignment_desktop",
					"label": "Horizontal Alignment"
				},
				{
					"type": "text",
					"id": "text_alignment_desktop",
					"label": "Text Alignment",
					"default": "left"
				},
				{
					"type": "header",
					"content": "Mobile Alignment"
				},
				{
					"type": "text",
					"id": "vertical_alignment_mobile",
					"label": "Vertical Alignment (Mobile)"
				},
				{
					"type": "text",
					"id": "horizontal_alignment_mobile",
					"label": "Horizontal Alignment Mobile"
				},
				{
					"type": "text",
					"id": "text_alignment_mobile",
					"label": "Text Alignment Mobile"
				},
				{
					"type": "header",
					"content": "Copy Settings"
				},
				{
					"type": "text",
					"id": "heading",
					"label": "Hero Heading",
					"default": "Video heading"
				},
				{
					"type": "color",
					"id": "heading_color",
					"label": "Hero Text Color",
					"default": "#fff"
				},
				{
					"type": "text",
					"id": "hero_subheading",
					"label": "Hero Subheading",
					"default": "subheading"
				},
				{
					"type": "color",
					"id": "subheading_color",
					"label": "Subheading Text Color",
					"default": "#fff"
				},
				{
					"type": "text",
					"id": "hero_caption",
					"label": "Hero Caption",
					"default": "caption"
				},
				{
					"type": "color",
					"id": "caption_color",
					"label": "Caption Text Color",
					"default": "#fff"
				},
				{
					"type": "text",
					"id": "btn_text",
					"label": "Hero Button Text",
					"default": "Button label"
				},
				{
					"type": "url",
					"id": "btn_link",
					"label": "Hero Button Link",
					"default": "/collections"
				}
			]
		}
	],
	"presets": [
		{
			"name": "Product Video Banner"
		}
	]
}
{% endschema %}