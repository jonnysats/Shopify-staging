{%- if block.settings.heading != blank and block.settings.option_list != blank -%}
	{%- liquid 
		comment
			# clean label input
		endcomment
		assign label = block.settings.heading | escape
		assign label_id = block.settings.heading | handleize | replace: '-', '_'
		assign label_name = label_id | prepend: 'contact[' | replace: '-', ' ' | append: ']'

		if block.settings.required == true or block.settings.precheck == true
			assign label = block.settings.heading | append: '<sup>*</sup>'
		endif

		comment
			# Build the Option list for Select
		endcomment
		assign select_default = block.settings.select_default
		assign option_split = block.settings.option_list | split: ';'
		assign default_found_in_array = option_split | where: select_default | first
													
		assign display_col = "col"
		case block.settings.display_type
			when "full"
				assign display_col = "col"
			when "half"
				assign display_col = "col-6"
			when "half-mobile"
				assign display_col = "col-6 col-lg-12"
			when "half-desktop"
				assign display_col = "col-12 col-lg-6"
		endcase
	-%}
	<div class="{{ display_col }} mb-2 mb-lg-3" {{ block.shopify_attributes }}>
		<div class="form-floating">
			<select id="{{ block.id }}{{ label_id }}" name="{{ label_name }}" class="form-select" aria-label="{{ label }}"{% if block.settings.required == true %} required{% endif %}>
				{%- if default_found_in_array == blank and block.settings.select_default != blank -%}
					<option value="{{ block.settings.select_default | strip | escape }}">{{ block.settings.select_default | escape }}</option>
				{%- endif -%}
				{%- for option in option_split -%}
					{%- liquid
						assign formatted_option = option | strip | escape
						assign formatted_default_found_in_array = default_found_in_array | strip | escape
					-%}
					<option value="{{ formatted_option }}"{% if formatted_option == formatted_default_found_in_array %} selected{% endif %}>{{ formatted_option }}</option>
				{%- endfor -%}
			</select>
			<label for="{{ block.id }}{{ label_id }}" class="form-label">{{ label }}</label>
		</div>
	</div>
{%- endif -%}
{% schema %}
{
	"name": "Select Input",
	"tag": null,
	"settings": [
		{
			"type": "select",
			"id": "display_type",
			"label": "Input display type",
			"options": [
				{
					"value": "full",
					"label": "Full width"
				},
				{
					"value": "half",
					"label": "Half width"
				},
				{
					"value": "half-mobile",
					"label": "Half width (mobile only)"
				},
				{
					"value": "half-desktop",
					"label": "Half width (desktop only)"
				}
			],
			"default": "half"
		},
		{
			"type": "text",
			"id": "heading",
			"label": "Label",
		},
		{
			"type": "text",
			"id": "option_list",
			"label": "Option list",
			"info": "IMPORTANT: Separate each option by a semicolumn (;)",
			"placeholder": "General inquiry; Order issue"
		},
		{
			"type": "text",
			"id": "select_default",
			"label": "Select default",
		},
		{
			"type": "checkbox",
			"id": "required",
			"label": "Required?",
			"default": false
		}
	],
	"presets": [
		{
			"name": "Select Input"
		}
	]
}
{% endschema %}