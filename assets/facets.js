!function(){var t={1842:function(){window.bluedgeusa.theme.Facets=class{constructor(t,i,s){this._container=t,this._type=i,this._id=s,this._selectors={facetsDataId:"facetsData",forms:"[data-filter-form]",productGridId:"productGridContainer",productCountId:"productCount",productCount:"[data-product-count]",facetTags:"[data-facet-tags]",defaultSort:"[data-filter-default-sort]",facetsRemove:"[data-facet-remove]",filterHeader:"[data-filter-header]",pricesData:"[data-price-filter-wrapper]",filtersPriceMin:'[name="filter.v.price.gte"]',filtersPriceMax:'[name="filter.v.price.lte"]',facetsApplyBtn:"[data-filter-btn]",mobileOnlySortItem:"#offcanvasSortBottom",sortDropdownLabel:".sort-dropdown .dropdown-toggle span"},this.forms=this._container.querySelectorAll(this._selectors.forms),this.activeForm=null,this.productGridContainer=document.getElementById(this._selectors.productGridId),this.productCounts=this._container.querySelectorAll(this._selectors.productCount),this.facetTags=this._container.querySelectorAll(this._selectors.facetTags),this.facetsRemove=this._container.querySelectorAll(this._selectors.facetsRemove),this.filterHeader=this._container.querySelectorAll(this._selectors.filterHeader),this.pricesData=this._container.querySelector(this._selectors.pricesData),this.filtersPriceMin=this._container.querySelectorAll(this._selectors.filtersPriceMin),this.filtersPriceMax=this._container.querySelectorAll(this._selectors.filtersPriceMax),this.applyBtns=this._container.querySelectorAll(this._selectors.facetsApplyBtn),this.mobileOnlySortItem=this._container.querySelector(this._selectors.mobileOnlySortItem),this.sortDropdownLabel=this._container.querySelector(this._selectors.sortDropdownLabel),this.setActiveForm(),this.isMobile=window.innerWidth<window.bluedgeusa.theme.cache.lg,this.dataCache=[],this.searchParams=this.getSearchParam(),this.debounceSpeed=500,this.searchParamsInitial=window.location.search.slice(1),this.searchParamsPrev=window.location.search.slice(1),this.defaultSort=this.getDefaultSortValue(),this.minFilterVal=this.pricesData?.dataset?.filterPriceMin?parseFloat(this.pricesData.dataset.filterPriceMin):0,this.maxFilterVal=this.pricesData?.dataset?.filterPriceMax?parseFloat(this.pricesData.dataset.filterPriceMax):0,this.e_removeFacetHandler=this.removeFacetHandler.bind(this),this.e_formSubmitHandler=this.formSubmitHandler.bind(this),this.e_windowResizeHandler=this.windowResizeHandler.bind(this),this.init()}init(){this.initEventListeners(),window.addEventListener("resize",window.bluedgeusa.core.Utils.debounce(this.e_windowResizeHandler,this.debounceSpeed))}fetchPageManager(t=null,i=!0,s=null){this.searchParams=s??this.getSearchParam(),this.searchParamsPrev=this.searchParams;const h=this.dataCache.find(i=>i.url===t);t=t||this.buildURL(),h?(i&&this.updateHistoryHash(),this.fetchPageCache(t)):(this.fetchPage(t),i&&this.updateHistoryHash())}fetchPage(t){fetch(t).then(t=>t.text()).then(i=>{this.dataCache.find(i=>i.url===t)||this.dataCache.push({url:t,html:i}),this.updateFacets(i),this.renderProductCount(i),this.renderFacetTags(i),this.renderProductGrid(i),this.renderFiltersHeaders(i),this.reattachRemoveFacet(i)}).catch(t=>this.renderFetchError(t))}fetchPageCache(t){const i=this.dataCache.find(i=>i.url===t);this.updateFacets(i.html),this.renderProductCount(i.html),this.renderFacetTags(i.html),this.renderProductGrid(i.html),this.renderFiltersHeaders(i.html),this.reattachRemoveFacet(i.html)}updateFacets(t){try{const i=(new DOMParser).parseFromString(t,"text/html").getElementById(this._selectors.facetsDataId).innerText,s=JSON.parse(i),h=this.getSearchParamObj();s.forEach(t=>{this.activeForm.querySelectorAll(`input[data-facet-input="${t.name}"]`).forEach(i=>{const s=h[i.name]||[];s.includes(i.value)||("checkbox"===i.type?1!=i.checked&&0!==t.count||(i.checked=!1):"number"===i.type&&("filter-v-price-gte"!==t.name||s.length||(i.value=0),"filter-v-price-lte"!==t.name||s.length||(i.value=i.dataset.maxRange))),"checkbox"!==i.type||i.checked||(i.disabled=0===t.count);const e=i.nextElementSibling;e&&e?.querySelector("span")&&(e.querySelector("span").innerText=t.count)})})}catch(t){}}renderProductGrid(t){this.productGridContainer.innerHTML="",this.productGridContainer.innerHTML=(new DOMParser).parseFromString(t,"text/html").getElementById(this._selectors.productGridId).innerHTML,window.lazyLoadInstance.update(),document.dispatchEvent(new CustomEvent("productsInjected"))}renderFiltersHeaders(t){(new DOMParser).parseFromString(t,"text/html").querySelectorAll(this._selectors.filterHeader).forEach((t,i)=>{this.filterHeader[i].innerHTML=t.innerHTML});const i=(new DOMParser).parseFromString(t,"text/html").querySelector(this._selectors.sortDropdownLabel);this.sortDropdownLabel&&i&&(this.sortDropdownLabel.innerHTML=i.innerHTML)}renderProductCount(t){const i=(new DOMParser).parseFromString(t,"text/html")?.getElementById(this._selectors.productCountId)?.innerHTML;this.productCounts.forEach(t=>t.innerHTML=i)}renderFacetTags(t){const i=(new DOMParser).parseFromString(t,"text/html").querySelector(this._selectors.facetTags).innerHTML;this.facetTags.forEach(t=>t.innerHTML=i)}reattachRemoveFacet(){this.facetsRemove.forEach(t=>t.removeEventListener("click",this.e_removeFacetHandler)),this.facetsRemove=[],this.facetTags.forEach(t=>{const i=t.querySelectorAll(this._selectors.facetsRemove);this.facetsRemove=Array.from(this.facetsRemove).concat(Array.from(i))}),this.facetsRemove.forEach(t=>t.addEventListener("click",this.e_removeFacetHandler))}initEventListeners(){this.isMobile?(this.applyBtns.forEach(t=>t.addEventListener("click",this.e_formSubmitHandler)),this.mobileOnlySortItem&&this.mobileOnlySortItem.addEventListener("change",window.bluedgeusa.core.Utils.debounce(this.e_formSubmitHandler,this.debounceSpeed))):this.activeForm.addEventListener("input",window.bluedgeusa.core.Utils.debounce(this.e_formSubmitHandler,this.debounceSpeed)),this.facetsRemove.forEach(t=>t.addEventListener("click",this.e_removeFacetHandler)),window.addEventListener("popstate",this.historyChangeHandler.bind(this))}windowResizeHandler(t){this.setActiveForm(t);const i=window.innerWidth<window.bluedgeusa.theme.cache.lg;i!==this.isMobile&&(this.isMobile=i,this.filterFormEventMethodHandler())}filterFormEventMethodHandler(){this.isMobile?(this.activeForm.removeEventListener("input",window.bluedgeusa.core.Utils.debounce(this.e_formSubmitHandler,this.debounceSpeed)),this.applyBtns.forEach(t=>t.addEventListener("click",this.e_formSubmitHandler)),this.mobileOnlySortItem&&this.mobileOnlySortItem.addEventListener("change",window.bluedgeusa.core.Utils.debounce(this.e_formSubmitHandler,this.debounceSpeed))):(this.applyBtns.forEach(t=>t.removeEventListener("click",this.e_formSubmitHandler)),this.mobileOnlySortItem&&this.mobileOnlySortItem.removeEventListener("change",window.bluedgeusa.core.Utils.debounce(this.e_formSubmitHandler,this.debounceSpeed)),this.activeForm.addEventListener("input",window.bluedgeusa.core.Utils.debounce(this.e_formSubmitHandler,this.debounceSpeed)))}formSubmitHandler(){if(this.fetchPageManager(),this.mobileOnlySortItem){window.bootstrap.Offcanvas.getOrCreateInstance(this.mobileOnlySortItem).hide()}}removeFacetHandler(t){t.preventDefault();const i=-1==t.currentTarget.href.indexOf("?")?"":t.currentTarget.href.slice(t.currentTarget.href.indexOf("?")+1);t.currentTarget.hasAttribute("data-facet-price")&&(this.filtersPriceMin.forEach(t=>t.value=this.minFilterVal),this.filtersPriceMax.forEach(t=>t.value=this.maxFilterVal));const s=`${window.location.pathname}?section_id=${this._id}&${i}`;this.fetchPageManager(s,!0,i)}historyChangeHandler(t){(t.state?t.state.searchParams:this.searchParamsInitial)!==this.searchParamsPrev&&this.fetchPageManager(null,!1)}updateHistoryHash(){history.pushState({searchParams:this.searchParams},"",`${window.location.pathname}${this.searchParams&&"?".concat(this.searchParams)}`)}renderFetchError(t){const i=document.createElement("h4");i.classList.add("collection-fetch-error"),i.innerText="An error occurred when fetching the products.",this.productGridContainer.innerHTML="",this.productGridContainer.append(i)}buildURL(t=null){return t&&(this.searchParams=t),this.searchParams?`${window.location.pathname}?section_id=${this._id}&${this.searchParams}`:`${window.location.pathname}?section_id=${this._id}`}getSearchParam(){const t=new FormData(this.activeForm),i=t.get("filter.v.price.gte"),s=t.get("filter.v.price.lte"),h=new URLSearchParams(t);return parseFloat(s)===Math.ceil(this.maxFilterVal)&&parseFloat(i)===Math.ceil(this.minFilterVal)&&(h.delete("filter.v.price.gte"),h.delete("filter.v.price.lte")),h.toString()}getSearchParamObj(){const t=new URLSearchParams(window.location.search),i={};for(const[s,h]of t)i[s]||(i[s]=[]),i[s].push(h);return i}getDefaultSortValue(){return document.querySelector(this._selectors.defaultSort)?.value}setActiveForm(){for(let t of this.forms)if(null!==t.offsetParent){this.activeForm=t;break}}onUnload(t){return window.lazyLoadInstance.update(),t}onLoad(t){return window.removeEventListener("resize",window.bluedgeusa.core.Utils.debounce(this.e_windowResizeHandler,this.debounceSpeed)),this.applyBtns.forEach(t=>t.removeEventListener("click",this.e_formSubmitHandler)),this.mobileOnlySortItem&&this.mobileOnlySortItem.removeEventListener("change",window.bluedgeusa.core.Utils.debounce(this.e_formSubmitHandler,this.debounceSpeed)),this.activeForm.removeEventListener("input",window.bluedgeusa.core.Utils.debounce(this.e_formSubmitHandler,this.debounceSpeed)),this.facetsRemove.forEach(t=>t.removeEventListener("click",this.e_removeFacetHandler)),window.removeEventListener("popstate",this.historyChangeHandler.bind(this)),t}}}},i={};function s(h){var e=i[h];if(void 0!==e)return e.exports;var r=i[h]={exports:{}};return t[h](r,r.exports,s),r.exports}s.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(i,{a:i}),i},s.d=function(t,i){for(var h in i)s.o(i,h)&&!s.o(t,h)&&Object.defineProperty(t,h,{enumerable:!0,get:i[h]})},s.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},function(){"use strict";s(1842);window.bluedgeusa.sections.register("shopifyFacets",window.bluedgeusa.theme.Facets)}()}();